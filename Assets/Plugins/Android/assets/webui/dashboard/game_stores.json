{"title":"Feint Game Stores","scrolling":true,"loadflow":"","init":"\nOF.setActiveFootermenu();OF.setFootermenu();$('body').addClass('textured');$('.button').pretouch();if(!OF.friendsList){OF.friendsList={init:function(){$('#friends').data('total_pages',1);$('#friends').data('next_page',1);$('#friends').data('is_loading_more',false);$('#load_more').hide();$('#friends_list > ul .user').remove();$('#friends ul#loading').unhide();OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}else{$(\"#load_more\").unhide();}\n$(\"#friends ul#loading\").hide();});},load_more:function(){if(!$('#friends').data('is_loading_more')){$('#friends').data('is_loading_more',true);$(\"#load_more\").html(\"\u8bfb\u53d6\u4e2d....\");OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}\n$(\"#load_more\").html(\"\u8bfb\u53d6\u66f4\u591a\");$('#friends').data('is_loading_more',false);});}},load_data:function(callback){OF.api.request('/xp/friends',{params:{user_id:OF.page.user.id,page:$('#friends').data('next_page'),per_page:10,for_friends_list_page_optimization:true},success:function(data){if($('#friends').data('next_page')==1){OF.friendsList.renderFriends(data.users);$('#friends').data('total_pages',data.total_pages);}else{OF.friendsList.addFriends(data.users);}\n$('#friends').data('next_page',$('#friends').data('next_page')+1);callback();}});},renderFriendItems:function(friends){var html=$.map(friends,function(friend){return tmpl('user_tmpl',friend);});return html;},renderFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);if(html.length>0){$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));$(\"#friends_list .no_data\").hide();}else{$('#friends_list > ul').hide();$(\"#friends_list .no_data\").unhide();}},addFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));}};}\n$('#home_button').touch(OF.menu.home);var game_id=OF.page.params.game_id;var the9_store_download_url=OF.page.params.the9_store_download_url;var the9_store_game_version=OF.page.params.the9_store_game_version;var cp_identifier=OF.page.params.cp_identifier;var game_stores;OF.page.abort=function(){OF.goBack();OF.alert('\u63d0\u793a','\u6ca1\u6709\u627e\u5230\u53ef\u4ee5\u4e0b\u8f7d\u6b64\u6e38\u620f\u7684\u5546\u57ce');}\nOF.page.renderGameStore=function(g_s){var html=$.map(g_s,function(data,index){return tmpl(\"game_store\",{index:index,game_store_platform:data.game_store_platform.game_store_info,game_store:data.game_store_platform.game_store})})\nif(the9_store_download_url&&OF.sdkSupportThe9Download){html.unshift('<div class=\"item normal\"><div class=\"icon the9_gamestore_icon\"><div class=\"free\"></div></div><div class=\"text\"><div class=\"itemtitle\" style=\"color:#ee9d00\">\u4e5d\u57ce\u6e38\u620f\u4e2d\u5fc3</div><div class=\"version\">\u6e38\u620f\u7248\u672c:'+the9_store_game_version+'</div></div><div class=\"btn\"><div class=\"prices\">\u514d\u8d39</div><a id=\"download_game_from_the9\" class=\"download_game\"></a></div></div>');}\n$(\".loading\").hide();$('#game_store_container').html(html.join(\" \"));$('#download_game_from_the9').touch(function(){OF.log(\"-----------Download game from the9 game center\");OF.sendAction('downloadFromThe9GameCenter',{the9_store_download_url:the9_store_download_url});});$('#game_store_container .game_store').touch(function(){var d=g_s[$('#game_store_container .game_store').index($(this))];OF.sendAction('openGameStore',{game_store_platform:d.game_store_platform.game_store_info,game_store:d.game_store_platform.game_store});})}\nOF.page.renderGameStoreList=function(game_store_string){var game_store_array=game_store_string.split(\"|\");if(game_store_array.length==1){OF.page.renderGameStore(game_stores.game_store_platforms);}else{var installed_game_stores=[];for(var j=0;j<game_store_array.length;j++){for(var i=0;i<game_stores.game_store_platforms.length;i++){if(OF.sdkSupportThe9Download){var game_store_identifier=game_stores.game_store_platforms[i].game_store_platform.game_store.name;}else{var game_store_identifier=game_stores.game_store_platforms[i].game_store_platform.game_store.package_name;}\nif(game_store_identifier==game_store_array[j]){game_stores.game_store_platforms[i].game_store_platform.game_store.installed=true;installed_game_stores.push(game_stores.game_store_platforms[i]);break;}}}\nOF.page.renderGameStore(installed_game_stores);}}\nOF.api.request('/xp/games/'+game_id+'/game_stores',{method:'GET',params:{cp_identifier:OF.page.params.cp_identifier},on404:OF.page.abort,failure:OF.page.abort,success:function(data){game_stores=data;var game_store_string='';for(var i=0;i<data.game_store_platforms.length;i++){if(OF.sdkSupportThe9Download){game_store_string+=data.game_store_platforms[i].game_store_platform.game_store.name+','}else{game_store_string+=data.game_store_platforms[i].game_store_platform.game_store.package_name+','}}\ngame_store_string=game_store_string.replace(/.$/,\"\");if(OF.isDevice){OF.sendAction('InstalledGameStore',{game_store:game_store_string,callback:'OF.page.renderGameStoreList'});}else{OF.page.renderGameStoreList('com.hiapk.market|');}\n$(\"#content\").unhide();$(\"#main_loader\").hide();}});","resume":"\nOF.setActiveFootermenu();","appear":"\n$('#header .title').html(OF.page.title);","html":"<div id='dashboard'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n<div class='title' id='home_button'></div>\n</div>\n          <script type=\"text/plain\" id=\"game_store\">\n            <% var style = \"item normal\"; %>\n  <% var font_style = \"#ee9d00\"; %>\n  <% var installation_info_style = \"display:none\"; %>\n  <% var game_store_style = \"download_game game_store\"; %>\n  <% var status = \"\"+game_store_platform.status+\"\"; %>\n  <% var installed = \"\"+game_store.installed+\"\"; %>\n  <% var usable = \"\"+game_store.usable+\"\"; %>\n  <% var index = \"\"+index+\"\"; %>\n  <% var hot_icon = \"hot_hidden\"; %>\n  <% var platform_version = \"\u6e38\u620f\u7248\u672c:\"+game_store_platform.version+\"\"; %>\n  <% var price = \"prices\"; %>\n  <% if(index == '0' && status != '0'){hot_icon = \"hot\";} %>\n  <% if(installed == 'false'){game_store_style = \"download_game game_store\";installation_info_style = \"color:red;font-size: 11px;\";} %>\n  <% if(platform_version == '\u6e38\u620f\u7248\u672c:null'){platform_version = '\u6682\u65e0\u7248\u672c\u4fe1\u606f';} %>\n  <div class=\"<%= style %>\">\n    <div class=\"icon\" style=\"background:url(<%= game_store.icon_url %>) left top no-repeat\">\n      <div class=\"<%= hot_icon %>\"></div>\n    </div>\n    <div class=\"text\">\n      <div class=\"itemtitle\" style=\"color:<%= font_style %>\"><%= game_store.name %></div>\n      <div class=\"version\"><%= platform_version %></div>\n      <div style=\"<%= installation_info_style %>\">\u9700\u8981\u5b89\u88c5\u6b64\u5546\u5e97</div>\n    </div>\n    <div class=\"btn\">\n      <div class=\"<%= price %>\">\uffe5<%= game_store_platform.price %></div>\n      <a class=\"<%= game_store_style %>\"></a>\n    </div>\n  </div>\n          </script>\n<div id='games'>\n<ul class='cells'>\n<li class='section_title'>\u8bf7\u9009\u62e9\u4e00\u4e2a\u5546\u57ce\u4e0b\u8f7d\u8be5\u6e38\u620f</li>\n</ul>\n</div>\n<div class='cell loading'>\n<div class='spinner'></div>\n</div>\n<div id='game_details'>\n<div id='game_store_container'></div>\n</div>\n\n<br clear='both'>\n<div id='footer'>\n<div class='footer_menu' id='footer_menu_for_2_1' style='display:none'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n<br clear='both'>\n<div class='footer_menu' id='footer_menu_for_2_2'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n"}
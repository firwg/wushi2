{"title":"\u6e38\u620f","scrolling":true,"loadflow":"","init":"\nOF.setActiveFootermenu();OF.setFootermenu();$('body').addClass('textured');$('.button').pretouch();if(!OF.friendsList){OF.friendsList={init:function(){$('#friends').data('total_pages',1);$('#friends').data('next_page',1);$('#friends').data('is_loading_more',false);$('#load_more').hide();$('#friends_list > ul .user').remove();$('#friends ul#loading').unhide();OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}else{$(\"#load_more\").unhide();}\n$(\"#friends ul#loading\").hide();});},load_more:function(){if(!$('#friends').data('is_loading_more')){$('#friends').data('is_loading_more',true);$(\"#load_more\").html(\"\u8bfb\u53d6\u4e2d....\");OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}\n$(\"#load_more\").html(\"\u8bfb\u53d6\u66f4\u591a\");$('#friends').data('is_loading_more',false);});}},load_data:function(callback){OF.api.request('/xp/friends',{params:{user_id:OF.page.user.id,page:$('#friends').data('next_page'),per_page:10,for_friends_list_page_optimization:true},success:function(data){if($('#friends').data('next_page')==1){OF.friendsList.renderFriends(data.users);$('#friends').data('total_pages',data.total_pages);}else{OF.friendsList.addFriends(data.users);}\n$('#friends').data('next_page',$('#friends').data('next_page')+1);callback();}});},renderFriendItems:function(friends){var html=$.map(friends,function(friend){return tmpl('user_tmpl',friend);});return html;},renderFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);if(html.length>0){$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));$(\"#friends_list .no_data\").hide();}else{$('#friends_list > ul').hide();$(\"#friends_list .no_data\").unhide();}},addFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));}};}\n$('#home_button').touch(OF.menu.home);OF.page.user=OF.page.params.user||OF.user;var gameID=OF.page.params.game_id;var reviewTmpl=tmpl('reviews_tmpl');$('#review_game').touch(function(){OF.push('dashboard/reviews/new',{params:{game_id:gameID}});});OF.reviewsList={init:function(){$.lazyLoad({threshold:0.5,nextPageLoaded:function(page,data){if(page==1){OF.reviewsList.renderReviews(data);}else{OF.reviewsList.renderReviews(data);}},nextPageShouldLoad:function(page,callback){$(\".loading\").unhide();OF.api('/xp/games/'+gameID+'/reviews',{params:{page:page,per_page:15},success:function(data){callback(data.reviews,data.review_count<10);},failure:function(){callback([]);},complete:function(){$(\".loading\").hide();}});},isEmpty:function(){},isFinished:function(){$(\".loading\").hide();}});},renderReviewItems:function(reviews){var html=\"\"\n$.each(reviews,function(){html+=reviewTmpl(this.review);});return html;},renderReviews:function(reviews){var html=OF.reviewsList.renderReviewItems(reviews);if(html.length>0){$('#review_list').append(html).unhide();}else{$(\"#reviews .no_more_data\").unhide();}}};OF.reviewsList.init();","resume":"\nOF.setActiveFootermenu();","appear":"\n$('#header .title').html(OF.page.title);","html":"<div id='dashboard'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n<div class='title' id='home_button'></div>\n</div>\n          <script type=\"text/plain\" id=\"reviews_tmpl\">\n            <li class=\"review\">\n  <div class=\"body\">\n    <div class=\"title\"><span data-href=\"dashboard/user?user_id=<%= user_id %>\"><%= user_name %></span></div>\n    <div class=\"content\"><%= body %></div>\n  </div>\n  <div class=\"info\">\n    <div class=\"created-at\"><%= created_at %></div>\n    <ul class=\"small-rating\">\n      <li><div class=\"one-star-unit <% if(rating == 1){ %> small-current-rating <% } %>\">1</div></li>\n      <li><div class=\"two-star-unit <% if(rating == 2){ %> small-current-rating <% } %>\">2</div></li>\n      <li><div class=\"three-star-unit <% if(rating == 3){ %> small-current-rating <% } %>\">3</div></li>\n      <li><div class=\"four-star-unit <% if(rating == 4){ %> small-current-rating <% } %>\">4</div></li>\n      <li><div class=\"five-star-unit <% if(rating == 5){ %> small-current-rating <% } %>\">5</div></li>\n      <li><div class=\"six-star-unit <% if(rating == 6){ %> small-current-rating <% } %>\">6</div></li>\n      <li><div class=\"seven-star-unit <% if(rating == 7){ %> small-current-rating <% } %>\">7</div></li>\n      <li><div class=\"eight-star-unit <% if(rating == 8){ %> small-current-rating <% } %>\">8</div></li>\n      <li><div class=\"nine-star-unit <% if(rating == 9){ %> small-current-rating <% } %>\">9</div></li>\n      <li><div class=\"ten-star-unit <% if(rating == 10){ %> small-current-rating <% } %>\">10</div></li>\n    </ul>\n  </div>\n  <div style=\"clear:both;height:0px;\">&nbsp;</div>\n</li>\n          </script>\n          <script type=\"text/plain\" id=\"no_reviews\">\n            <li class=\"no_data\">\u6682\u65e0\u8bc4\u8bba</li>\n          </script>\n<div id='reviews'>\n<div class='button' id='review_game'>\u53d1\u8868\u8bc4\u8bba</div>\n<ul class='cells' id='review_list'></ul>\n<ul>\n<li class='loading hide' style='list-style:none;'>\n<div class='spinner'></div>\n</li>\n</ul>\n<div class='no_more_data hidden'>\"\u6ca1\u6709\u66f4\u591a\u8bc4\u8bba\u4e86\"</div>\n</div>\n\n<br clear='both'>\n<div id='footer'>\n<div class='footer_menu' id='footer_menu_for_2_1' style='display:none'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n<br clear='both'>\n<div class='footer_menu' id='footer_menu_for_2_2'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n"}
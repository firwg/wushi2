{"title":"\u6e38\u620f","scrolling":true,"loadflow":"","init":"\nOF.setActiveFootermenu();OF.setFootermenu();$('body').addClass('textured');$('.button').pretouch();if(!OF.friendsList){OF.friendsList={init:function(){$('#friends').data('total_pages',1);$('#friends').data('next_page',1);$('#friends').data('is_loading_more',false);$('#load_more').hide();$('#friends_list > ul .user').remove();$('#friends ul#loading').unhide();OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}else{$(\"#load_more\").unhide();}\n$(\"#friends ul#loading\").hide();});},load_more:function(){if(!$('#friends').data('is_loading_more')){$('#friends').data('is_loading_more',true);$(\"#load_more\").html(\"\u8bfb\u53d6\u4e2d....\");OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}\n$(\"#load_more\").html(\"\u8bfb\u53d6\u66f4\u591a\");$('#friends').data('is_loading_more',false);});}},load_data:function(callback){OF.api.request('/xp/friends',{params:{user_id:OF.page.user.id,page:$('#friends').data('next_page'),per_page:10,for_friends_list_page_optimization:true},success:function(data){if($('#friends').data('next_page')==1){OF.friendsList.renderFriends(data.users);$('#friends').data('total_pages',data.total_pages);}else{OF.friendsList.addFriends(data.users);}\n$('#friends').data('next_page',$('#friends').data('next_page')+1);callback();}});},renderFriendItems:function(friends){var html=$.map(friends,function(friend){return tmpl('user_tmpl',friend);});return html;},renderFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);if(html.length>0){$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));$(\"#friends_list .no_data\").hide();}else{$('#friends_list > ul').hide();$(\"#friends_list .no_data\").unhide();}},addFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));}};}\n$('#home_button').touch(OF.menu.home);var gameTmpl=tmpl('game_tmpl');OF.page.recommend_games=function(){OF.api.request('/xp/promotions/recommend_games/games/random',{loader:'#recommend_games_loading',params:{for_recommend_games_page_optimization:'true'},success:function(data){$('#recommend_games_loading').hide();var first_recommend_game=data.promoted_games[0].promoted_game;var second_recommend_game=data.promoted_games[1].promoted_game;$(\"#first_recommend_game\").unhide().css({\"background\":\"url(\"+first_recommend_game.wide_icon_url+\") no-repeat\"});$(\"#second_recommend_game\").unhide().css({\"background\":\"url(\"+second_recommend_game.wide_icon_url+\") no-repeat\"});$(\"#first_recommend_game\").touch(function(){OF.push('dashboard/game',{params:{game:first_recommend_game.game}});});$(\"#second_recommend_game\").touch(function(){OF.push('dashboard/game',{params:{game:second_recommend_game.game}});});},failure:function(){}});}\nOF.page.game_page=1;OF.page.per_page=10;OF.page.games=[];OF.page.sendGamesRequest=function(){OF.api.request('/xp/games',{params:{page:OF.page.game_page,per_page:OF.page.per_page},success:function(data){OF.page.game_page=OF.page.game_page+1;var html='';if(data.games.length>0){$('#more_games').unhide();$.each(data.games,function(i){OF.page.games.push(data.games[i]);this.game.index=((OF.page.game_page-2)*OF.page.per_page+i);html+=gameTmpl(this.game);});$('.game_cell').touch(function(){var game=OF.page.games[parseInt($(this).attr('data-game_index'))].game;OF.push('dashboard/game',{params:{game:game}});});$('#game_list').append(html);$('#more_games').html('\u67e5\u770b\u66f4\u591a\u6e38\u620f').touch(function(){$('#more_games').html('\u6b63\u5728\u52a0\u8f7d\u6e38\u620f...').touch(function(){return true;});OF.page.sendGamesRequest();});}else{$('#more_games').css({'opacity':'0.7'}).html('\u5df2\u52a0\u8f7d\u5168\u90e8\u7684\u63a8\u8350\u6e38\u620f\uff01\uff01\uff01').touch(function(){return true;});}}});}\nOF.page.recommend_games();OF.page.sendGamesRequest();","resume":"\nOF.setActiveFootermenu();$('#recommend_games_loading').unhide();$('#first_recommend_game').hide();$('#second_recommend_game').hide();OF.page.recommend_games();","appear":"\n$('#header .title').html(OF.page.title);","html":"<div id='dashboard'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n<div class='title' id='home_button'></div>\n</div>\n          <script type=\"text/plain\" id=\"game_tmpl\">\n            <% var icon_url = OF.deviceType.Android ? android_icon_url : ios_icon_url; %>\n<% var style = null; %>\n<% if (icon_url) { style = \"background-image: url(\" + icon_url + \")\"; } %>\n\n<li class=\"game_cell one_line\" data-game_index=\"<%= index %>\">\n  <div class=\"icon\" style=\"<%= style  %>\"></div>\n  <div class=\"title\"><%= name %></div>\n</li>\n          </script>\n<div id='games'>\n<ul class='cells recommend_games_container'>\n<div class='loading' id='recommend_games_loading'>\n<div class='spinner'></div>\n</div>\n<li class='hidden' id='first_recommend_game'></li>\n<div class='frame'></div>\n<li class='hidden' id='second_recommend_game'></li>\n<div class='frame'></div>\n</ul>\n<ul class='cells' id='game_list'></ul>\n<div class='hidden button' id='more_games' style='line-height:30px;height:50px;width:100%;text-align:center;margin-top:0px'>\n\u67e5\u770b\u66f4\u591a\u6e38\u620f\n</div>\n</div>\n\n<br clear='both'>\n<div id='footer'>\n<div class='footer_menu' id='footer_menu_for_2_1' style='display:none'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n<br clear='both'>\n<div class='footer_menu' id='footer_menu_for_2_2'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n"}
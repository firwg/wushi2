{"title":"\u8bbe\u7f6e\u90ae\u7bb1\u548c\u5bc6\u7801","scrolling":true,"loadflow":"","init":"\nOF.setActiveFootermenu();OF.setFootermenu();$('body').addClass('textured');$('#subheader').text(_(OF.page.title));$('#init_account_form').submit(function(){if($(this).isLoading())return false;if($('#init_account_form').isFormFilled(\"\u8bf7\u586b\u5199\u60a8\u7684\u90ae\u7bb1\u548c\u5bc6\u7801\u6765\u5b8c\u5584\u60a8\u7684\u4e2a\u4eba\u5e10\u53f7\u4fe1\u606f\u3002\")){$(this).isLoading(true);var newEmail=$('#user_http_basic_credential_attributes_email').val();var password=$(\"#user_http_basic_credential_attributes_password\").val();var password_confirm=$(\"#user_http_basic_credential_attributes_password_confirmation\").val();var email_regex=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/;var password_alert=\"\";var email_alert=\"\";if(!email_regex.test(newEmail)){email_alert=\"\u90ae\u7bb1\u683c\u5f0f\u9519\u8bef\u3002\";}\nif(password!=password_confirm){password_alert=\"\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u4e00\u81f4\u3002\"}\nif(password.length<6||password_confirm.length<6){password_alert=password_alert+\"\u5bc6\u7801\u4e0d\u5f97\u5c11\u4e8e6\u4e2a\u5b57\u7b26\";}\nif(email_alert!=\"\"||password_alert!=\"\"){alert(email_alert+\" \"+password_alert);$('#init_account_form').isLoading(false);return false;}else{OF.api.request('/xp/users/'+OF.user.id,{method:'PUT',loader:'#submit',params:{user:{http_basic_credential_attributes:{email:newEmail,password:password,password_confirmation:password_confirm}}},success:function(){OF.goBack();OF.alert(_('Success'),_('You have changed your email to: %1',newEmail));},failure:function(data){if(data.exception){if(data.exception['class']=='PlayerNotAuthenticated'){OF.alert(_('Error'),_('Your curent password was not correct.'));}else{return false;}}else{return false;}},complete:function(){$('#init_account_form').isLoading(false);}});}}\nreturn false;});$('#submit').touch(function(){$('#init_account_form').submit();});","resume":"\nOF.setActiveFootermenu();","appear":"","html":"<div id='settings'>\n<div class='t' id='header'>Settings</div>\n<div id='subheader'></div>\n<form id='init_account_form'>\n<p class='t' style='color: #ffffff'> \u8bbe\u7f6e\u6210\u529f\u540e\uff0c\u53ef\u5728\u5176\u4ed6\u8bbe\u5907\u4e0a\u4f7f\u7528\u60a8\u7684\u4e5d\u57ce\u6e38\u620f\u4e2d\u5fc3\u5e10\u6237</p>\n<div class='input_field'>\n<label class='t'>New Password</label>\n<input id='user_http_basic_credential_attributes_password' name='user[http_basic_credential_attributes][password]' type='password'>\n</div>\n<div class='input_field'>\n<label class='t'>Confirm Password</label>\n<input id='user_http_basic_credential_attributes_password_confirmation' name='user[http_basic_credential_attributes][password_confirmation]' type='password'>\n</div>\n<div class='input_field'>\n<label class='t'>New Email Address</label>\n<input id='user_http_basic_credential_attributes_email' name='user[http_basic_credential_attributes][email]' type='text'>\n</div>\n<div class='button t' id='submit'>Okay</div>\n</form>\n\n<br clear='both'>\n<div id='footer'>\n<div class='footer_menu' id='footer_menu_for_2_1' style='display:none'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n<br clear='both'>\n<div class='footer_menu' id='footer_menu_for_2_2'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n"}
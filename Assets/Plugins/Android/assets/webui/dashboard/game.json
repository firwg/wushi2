{"title":"\u6e38\u620f","scrolling":true,"loadflow":"","init":"\nOF.setActiveFootermenu();OF.setFootermenu();$('body').addClass('textured');$('.button').pretouch();if(!OF.friendsList){OF.friendsList={init:function(){$('#friends').data('total_pages',1);$('#friends').data('next_page',1);$('#friends').data('is_loading_more',false);$('#load_more').hide();$('#friends_list > ul .user').remove();$('#friends ul#loading').unhide();OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}else{$(\"#load_more\").unhide();}\n$(\"#friends ul#loading\").hide();});},load_more:function(){if(!$('#friends').data('is_loading_more')){$('#friends').data('is_loading_more',true);$(\"#load_more\").html(\"\u8bfb\u53d6\u4e2d....\");OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}\n$(\"#load_more\").html(\"\u8bfb\u53d6\u66f4\u591a\");$('#friends').data('is_loading_more',false);});}},load_data:function(callback){OF.api.request('/xp/friends',{params:{user_id:OF.page.user.id,page:$('#friends').data('next_page'),per_page:10,for_friends_list_page_optimization:true},success:function(data){if($('#friends').data('next_page')==1){OF.friendsList.renderFriends(data.users);$('#friends').data('total_pages',data.total_pages);}else{OF.friendsList.addFriends(data.users);}\n$('#friends').data('next_page',$('#friends').data('next_page')+1);callback();}});},renderFriendItems:function(friends){var html=$.map(friends,function(friend){return tmpl('user_tmpl',friend);});return html;},renderFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);if(html.length>0){$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));$(\"#friends_list .no_data\").hide();}else{$('#friends_list > ul').hide();$(\"#friends_list .no_data\").unhide();}},addFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));}};}\n$('#home_button').touch(OF.menu.home);var gt=new Gettext({'domain':'categories','locale_data':{\"categories\":{\"shoot_game\":[null,\"\u98de\u884c\u5c04\u51fb\"],\"puzzle_or_leisure\":[null,\"\u76ca\u667a\u4f11\u95f2\"],\"racing_or_sports\":[null,\"\u4f53\u80b2\u7ade\u901f\"],\"card_or_board\":[null,\"\u68cb\u724c\u6e38\u620f\"],\"rpg\":[null,\"\u89d2\u8272\u626e\u6f14\"],\"simulation_or_strategy\":[null,\"\u7ecf\u8425\u7b56\u7565\"],\"action_or_adventure\":[null,\"\u52a8\u4f5c\u5192\u9669\"],\"online_game\":[null,\"\u7f51\u7edc\u6e38\u620f\"]}}});var game=OF.page.params.game;OF.page.game=game;var reviewTmpl=tmpl('review_tmpl');var newReviewTmpl=tmpl('new_review_tmpl');var moreReviewTmpl=tmpl('more_review_tmpl');$('li#game_info .icon').css('background-image','url('+game.android_icon_url+')');$('li#game_info .title').text(OF.truncate(game.name,10));$('li#game_info .subtitle').text(game.developer_name);OF.page.buyCpButtonLabel=function(price){if(OF.page.game.description.the9_store_download_url&&OF.sdkSupportThe9Download){return\"\u514d\u8d39\";}else{if(typeof price==\"undefined\"){return\"\u8d2d\u4e70\";}else if(price<=0){return\"\u514d\u8d39\";}else if(price==\"none\"){return\"\u514d\u8d39\";}else{return\"\u8d2d\u4e70 <div class='price'>\uffe5\"+price+\"</div>\";}}}\nOF.api('/xp/games/'+game.id+'/descriptions/android',{method:'GET',params:{for_dashboard_game_optimization:'true'},success:function(data){$('li#game_info .category').text(\"\u6e38\u620f\u7c7b\u578b:\"+gt.gettext(data.description.category));OF.page.game.description=data.description;OF.page.default_game_store=function(cp_identifier){$('#buy').html(OF.page.buyCpButtonLabel(OF.page.game.description.game_store_price)).unhide();if(OF.page.game.description.game_store_counter=='0'||OF.page.game.description.game_store_counter==0){if(OF.page.game.description.the9_store_download_url&&OF.sdkSupportThe9Download){$('#buy').html('\u4e5d\u57ce\u5b98\u65b9\u4e0b\u8f7d').touch(function(){OF.log(\"-----------Download game from the9 game center\");OF.sendAction('downloadFromThe9GameCenter',{the9_store_download_url:OF.page.game.description.the9_store_download_url});});}else{$('#buy').touch(function(){OF.alert('\u63d0\u793a','\u6682\u65f6\u65e0\u6cd5\u63d0\u4f9b\u4e0b\u8f7d, \u656c\u8bf7\u671f\u5f85');});}}else{$('#buy').touch(function(){OF.navigateToUrl('dashboard/game_stores',{params:{game_id:OF.page.game.id,cp_identifier:cp_identifier,the9_store_download_url:OF.page.game.description.the9_store_download_url,the9_store_game_version:OF.page.game.description.the9_store_game_version}});});}};OF.page.onIsInstalled=function(installed,cp_identifier){if(installed){$('#buy').addClass('disabled').text('\u5df2\u5b89\u88c5').unhide();}else{if(cp_identifier=='default'||cp_identifier=='spotlight_default'){OF.page.default_game_store(cp_identifier);}else{OF.api('/xp/games/'+game.id+'/cp_stores/'+cp_identifier,{method:'GET',on404:OF.page.default_game_store,failure:OF.page.default_game_store,success:function(d){$('#buy_area').attr('style','float:right;margin-top:-10px');if(d.game_store_platform.game_store_info.price==\"none\"){if(OF.page.game.description.the9_store_download_url&&OF.sdkSupportThe9Download&&(cp_identifier!=\"motorola\"&&cp_identifier!=\"tianyu\"&&cp_identifier!=\"htc\")){var h=\"<p style='height:8px'>\u4e5d\u57ce\u5b98\u65b9\u4e0b\u8f7d</p><p style='height:8px'>\u514d\u8d39</p>\";$('#cp_buy').html(h).unhide().touch(function(){OF.sendAction('downloadFromThe9GameCenter',{the9_store_download_url:OF.page.game.description.the9_store_download_url});});}else{var h=\"<p style='height:8px'>\"+d.game_store_platform.game_store.name+\"</p><p style='height:8px'>\u4e0b\u8f7d</p>\";$('#cp_buy').html(h).unhide().touch(function(){OF.alert('\u63d0\u793a','\u6682\u65f6\u65e0\u6cd5\u63d0\u4f9b\u4e0b\u8f7d, \u656c\u8bf7\u671f\u5f85');});}}else{var h=\"<p style='height:8px'>\"+d.game_store_platform.game_store.name+\"</p><p style='height:8px'>\uffe5\"+d.game_store_platform.game_store_info.price+\"</p>\";$('#cp_buy').html(h).unhide().touch(function(){OF.sendAction('openGameStore',{game_store_platform:d.game_store_platform.game_store_info,game_store:d.game_store_platform.game_store});});}}});}}}\nif(OF.isDevice){OF.sendAction('isApplicationInstalled',{package_name:OF.page.game.description.package_identifier,callback:'OF.page.onIsInstalled'});}else{OF.page.onIsInstalled(false,\"tianyu\");}\n$('.game_description').html(OF.page.game.description.description.replace(/\\n/g,'<br>'));if(OF.page.game.description.screenshots.length){var lastThumbnailIdx=-1;$('.thumbnail').hide();$.each(OF.page.game.description.screenshots.slice(0,4),function(i){lastThumbnailIdx++;$('.thumbnail:eq('+i+')').show();$('.thumbnail:eq('+i+') img').data('isLandscape',this.is_landscape)\n[0].src=this.url;});$('#main').css('background-image','url('+OF.page.game.description.screenshots[0].url+')')\n[0].className=(OF.page.game.description.screenshots[0].is_landscape?'landscape':'');if(OF.page.game.description.screenshots.length&&OF.page.game.description.youtube.video_id&&OF.page.game.description.youtube.video_id.length){$('.thumbnail:eq('+lastThumbnailIdx+')').addClass('youtube').append(\"<span class='movie_play_overlay'></span>\")}\n$('.thumbnail').touch(function(){if($(this).hasClass('youtube')){OF.sendAction('openYoutubePlayer',{video_id:OF.page.game.description.youtube.video_id});}else{var mainImg=$('#main')\nvar tappedImg=$(this).children('img');mainImg.css('background-image','url('+tappedImg[0].src+')');mainImg[0].className=tappedImg.data('isLandscape')?'landscape':'';}});}\nif(OF.page.game){var userTmpl=tmpl('a_user_activity');var html=[];length_count=data.user_activity.length;if(length_count>0){$('li.section_title.activities').unhide();$('ul#activities_list').unhide();$.each(data.user_activity,function(){html.push(userTmpl(this));});$('ul#activities_list').append(html.join(\"\"));}else{$('li.section_title.activities').hide();$('ul#activities_list').hide();}}},on404:function(data){OF.goBack();OF.alert(_('No Game Info'),_('The developer of this game has not yet setup all the information for this screen.'));},failure:$.noop});var init_reviews=function(){OF.api('/xp/games/'+game.id+'/reviews',{params:{limit:4},success:function(data){if(data.reviews.length>0){$('li.section_title.reviews').unhide();$('ul#reviews').unhide();var html='';$.each(data.reviews,function(){html+=reviewTmpl(this.review);});$('ul#reviews').append(html);$(\"ul#reviews\").append(moreReviewTmpl({game_id:game.id}));}else{$(\"ul#reviews\").html(newReviewTmpl({game_id:game.id}));}\n$(\"#reviews li.loading\").hide();},failure:function(data,status){$(\"#reviews li.loading\").hide();}});}\n$('#review_game').touch(function(){OF.push('dashboard/reviews/new',{params:{game_id:game.id}});});$('#share_banner').touch(function(){var game_id=game.id;OF.navigateToUrl('dashboard/shareto',{params:{gameid:game_id}});});OF.page.initTabs=function(){if(OF.page.game){$('#recent_reviews').hide();$('#recent_activities').unhide();}else{$('#recent_activities').hide();$('#recent_activities').hide();}\n$('#tabbed_activity_navigation .tab').touch(function(){$('#tabbed_activity_navigation .tab').removeClass(\"active\");$(this).addClass(\"active\");if(this.id==\"recent_reviews_tab\"){$('#recent_reviews').unhide();$('#recent_activities').hide();$(\"ul#reviews\").html(\"<li class='loading'><div class='spinner'></div></li>\");init_reviews();}else{$('#recent_reviews').hide();$('#recent_activities').unhide();};});};OF.page.initTabs();","resume":"\nOF.setActiveFootermenu();","appear":"\n$('#header .title').html(OF.page.title);","html":"<div id='dashboard'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n<div class='title' id='home_button'></div>\n</div>\n          <script type=\"text/plain\" id=\"a_user_activity\">\n            <li class=\"user_activity\">\n  <% if ( source_type == \"client_application_users\" ) { %>\n    <div class=\"game_text\"><span class=\"user_activity_link\" data-href=\"dashboard/user?user_id=<%= uid %>\"><%= username %></span> \u5f00\u901a\u4e86 <span class=\"game_activity_link\" game_id=\"<%= game_id %>\"><%= gamename %>\u6e38\u620f </span></div>\n  <% } %>\n  <% if ( source_type == \"unlocked_achievement\" ) { %><div class=\"game_text\"><span class=\"user_activity_link\" data-href=\"dashboard/user?user_id=<%= uid %>\"><%= username %></span> \u83b7\u5f97\u4e86 <span class=\"game_activity_link\" game_id=\"<%= game_id %>\"><%= gamename %>\u6e38\u620f </span>\u7684<%= achievement %> \u6210\u5c31</div><% } %>\n  <% if ( source_type == \"high_score\" ) { %><div class=\"game_text\"><span class=\"user_activity_link\" data-href=\"dashboard/user?user_id=<%= uid %>\"><%= username %></span> \u5728 <span class=\"game_activity_link\" game_id=\"<%= game_id %>\"><%= gamename %>\u6e38\u620f </span>\u4e2d\u5237\u65b0\u4e86\u81ea\u5df1\u7684\u6700\u597d\u6210\u7ee9</div><% } %>\n <% if ( source_type == \"review_game\" ) { %><div class=\"game_text\"><span class=\"user_activity_link\" data-href=\"dashboard/user?user_id=<%= uid %>\"><%= username %></span> \u5bf9<%= gamename %>\u6e38\u620f \u53d1\u8868\u4e86<span class=\"game_activity_link\" game_id=\"<%= game_id %>\" data-href=\"dashboard/reviews/index?game_id=<%= game_id %>\">\u8bc4\u8bba</span></div><% } %>\n</li>\n          </script>\n          <script type=\"text/plain\" id=\"review_tmpl\">\n            <li class=\"review\">\n  <div class=\"body\">\n    <div class=\"title\"><span data-href=\"dashboard/user?user_id=<%= user_id %>\"><%= user_name %></span></div>\n    <div class=\"content\"><%=OF.truncate(body,12) %></div>\n  </div>\n  <div class=\"info\">\n    <div class=\"created-at\"><%= created_at %></div>\n    <ul class=\"small-rating\">\n      <li><div class=\"one-star-unit <% if(rating == 1){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"two-star-unit <% if(rating == 2){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"three-star-unit <% if(rating == 3){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"four-star-unit <% if(rating == 4){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"five-star-unit <% if(rating == 5){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"six-star-unit <% if(rating == 6){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"seven-star-unit <% if(rating == 7){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"eight-star-unit <% if(rating == 8){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"nine-star-unit <% if(rating == 9){ %> small-current-rating <% } %>\">a</div></li>\n      <li><div class=\"ten-star-unit <% if(rating == 10){ %> small-current-rating <% } %>\">a</div></li>\n    </ul>\n  </div>\n</li>\n          </script>\n          <script type=\"text/plain\" id=\"new_review_tmpl\">\n            <li id=\"no_reviews\">\u6682\u65e0\u8bc4\u8bba\uff0c<span class=\"view_more\" data-href=\"dashboard/reviews/new?game_id=<%=game_id%>\">\u5199\u4e0b\u4f60\u5bf9\u8fd9\u6b3e\u6e38\u620f\u7684\u8bc4\u4ef7\uff01</span></li>\n          </script>\n          <script type=\"text/plain\" id=\"more_review_tmpl\">\n            <li id=\"all_reviews\"><span class=\"view_more\" data-href=\"dashboard/reviews/index?game_id=<%=game_id%>\">\u67e5\u770b\u66f4\u591a\u8bc4\u8bba\uff01</span></li>\n          </script>\n<div id='games'>\n<ul class='cells'>\n<li class='liquid clearfix' id='game_info'>\n<div id='buy_area' style='float:right;'>\n<div class='hidden button' id='cp_buy' style='margin:0px 0px 8px 0px;width:92px;font-size:9pt;height:50px;line-height:30px;padding:0px'></div>\n<div class='hidden button' id='buy'></div>\n</div>\n<div id='game_title_area'>\n<div class='icon'></div>\n<div class='title'></div>\n<div class='subtitle subtitle_for_game'></div>\n<div class='category subtitle_for_game'></div>\n</div>\n</li>\n<section id='tabbed_activity_navigation'>\n<ul class='tabs'>\n<li class='tab active' id='recent_activity_tab'>\n<div class='label'>\u73a9\u5bb6\u52a8\u6001</div>\n</li>\n<li class='tab' id='recent_reviews_tab'>\n<div class='label t'>\u73a9\u5bb6\u8bc4\u8bba</div>\n</li>\n</ul>\n</section>\n<div class='hidden' id='recent_activities'>\n<ul class='adopt_cells' id='activities_list'></ul>\n</div>\n<div class='hidden' id='recent_reviews'>\n<ul class='adopt_cells' id='reviews'></ul>\n</div>\n<li class='icon' id='share_banner'></li>\n<li class='section_title t'>Screenshots</li>\n<li class='liquid clearfix' id='screenshots'>\n<div id='main'></div>\n<div id='thumbnails'>\n<div class='thumbnail'>\n<img>\n</div>\n<div class='thumbnail'>\n<img>\n</div>\n<div class='thumbnail'>\n<img>\n</div>\n<div class='thumbnail'>\n<img>\n</div>\n</div>\n</li>\n<li class='section_title t'>Game Information</li>\n<li class='game_description liquid'></li>\n</ul>\n<div class='button default' id='review_game' style='line-height:32px'>\u53d1\u8868\u8bc4\u8bba</div>\n</div>\n\n<br clear='both'>\n<div id='footer'>\n<div class='footer_menu' id='footer_menu_for_2_1' style='display:none'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n<br clear='both'>\n<div class='footer_menu' id='footer_menu_for_2_2'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n"}
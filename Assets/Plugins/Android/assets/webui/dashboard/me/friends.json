{"title":"Feint Friends","scrolling":true,"loadflow":"","init":"\nOF.setActiveFootermenu();OF.setFootermenu();$('body').addClass('textured');$('.button').pretouch();if(!OF.friendsList){OF.friendsList={init:function(){$('#friends').data('total_pages',1);$('#friends').data('next_page',1);$('#friends').data('is_loading_more',false);$('#load_more').hide();$('#friends_list > ul .user').remove();$('#friends ul#loading').unhide();OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}else{$(\"#load_more\").unhide();}\n$(\"#friends ul#loading\").hide();});},load_more:function(){if(!$('#friends').data('is_loading_more')){$('#friends').data('is_loading_more',true);$(\"#load_more\").html(\"\u8bfb\u53d6\u4e2d....\");OF.friendsList.load_data(function(){if($('#friends').data('next_page')>$('#friends').data('total_pages')){$(\"#load_more\").hide();}\n$(\"#load_more\").html(\"\u8bfb\u53d6\u66f4\u591a\");$('#friends').data('is_loading_more',false);});}},load_data:function(callback){OF.api.request('/xp/friends',{params:{user_id:OF.page.user.id,page:$('#friends').data('next_page'),per_page:10,for_friends_list_page_optimization:true},success:function(data){if($('#friends').data('next_page')==1){OF.friendsList.renderFriends(data.users);$('#friends').data('total_pages',data.total_pages);}else{OF.friendsList.addFriends(data.users);}\n$('#friends').data('next_page',$('#friends').data('next_page')+1);callback();}});},renderFriendItems:function(friends){var html=$.map(friends,function(friend){return tmpl('user_tmpl',friend);});return html;},renderFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);if(html.length>0){$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));$(\"#friends_list .no_data\").hide();}else{$('#friends_list > ul').hide();$(\"#friends_list .no_data\").unhide();}},addFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);$(html.join(\" \")).insertBefore($(\"#friends_list > ul #load_more\"));}};}\n$('#home_button').touch(OF.menu.home);OF.page.user=OF.user;OF.shouldRefreshPage=false;OF.page.initRequest=function(){var reqCell=$('#requests');if(OF.page.user.received_friend_requests_pending_count>0){reqCell.unhide();reqCell.find('.title').text(_('%1 Friend Requests',OF.page.user.received_friend_requests_pending_count));}else{reqCell.hide();}};$(\"#load_more\").touch(function(){OF.friendsList.load_more();});var recommend_users_request=function(container_id){$(container_id).unhide().html(\"<li class='loading'><div class='spinner'></div></li>\");OF.api.request('/xp/users/recommend_friends',{method:'GET',success:function(data){OF.page.users=data.users;var html='';$.map(OF.page.users,function(user){html+=tmpl('recommend_user_tmpl',user);});$(container_id).html(html);}});};OF.page.initTabs=function(){$('#tabbed_friend_navigation .tab').removeClass(\"active\");if(OF.page.user.friendship_count>0){$('#friends_tab').addClass(\"active\");$('#friends_search').hide();$('#friends_container').unhide();OF.friendsList.init();}else{$('#find_friends_tab').addClass(\"active\");$('#friends_container').hide();$('#friends_search').unhide();recommend_users_request('#friends_search #recommend_friends > ul');}\n$('#tabbed_friend_navigation .tab').touch(function(){$('#tabbed_friend_navigation .tab').removeClass(\"active\");$(this).addClass(\"active\");if(this.id==\"find_friends_tab\"){$('#friends_container').hide();$('#friends_search').unhide();recommend_users_request('#friends_search #recommend_friends > ul');}else{$('#friends_search').hide();$('#friends_container').unhide();if(OF.page.user.friendship_count>0){$('#friends_container #friends_list').unhide();$('#friends_container #recommend_friends').hide();$('#friends_container .find_friends').hide();OF.friendsList.init();}else{$('#friends_container #friends_list').hide();$('#friends_container #recommend_friends').unhide();$('#friends_container .find_friends').unhide();recommend_users_request('#friends_container #recommend_friends > ul');}}});};$('.add_recommend_friend').touch(function(){var _this=$(this);_this.html(\"\u6b63\u5728\u6dfb\u52a0...\");var _friend_id=$(this).attr('id');OF.api.request('/xp/friend_requests',{background:true,method:'POST',params:{friend_id:_friend_id},success:function(){_this.hide();$('#pending_friend_'+_friend_id).unhide();OF.page.user.friendship_count++;},on404:function(){}});});OF.page.initRequest();OF.page.initTabs();OF.page.weiboDidReturn=function(retval){OF.api.request(\"/xp/link\",{method:\"POST\",params:{token:retval},success:function(){OF.navigateToUrl(\"dashboard/weibo/friends\");}});};OF.page.renrenDidReturn=function(retval){OF.api.request(\"/xp/rrlink\",{method:\"POST\",params:{token:retval},success:function(){OF.navigateToUrl(\"dashboard/renren/friends\");}});};OF.page.tencentDidReturn=function(retval){OF.api.request(\"/xp/txlink\",{method:\"POST\",params:{token:retval},success:function(){OF.navigateToUrl(\"dashboard/tencent/friends\");}});};OF.shouldRefreshPage=true;OF.page.facebookDidFailtown=function(errorCode,errorDesc){OF.log(_('Weibo fail (%1), `%2`',errorCode,errorDesc));OF.alert(errorDesc,_('Sorry!  We can&apos;t reach the Internet right now.  Please try again later.'));};if(OF.actionIsSupported('openBrowser')){$('#facebook_search').touch(function(){OF.api.request('/xp/geturl',{method:\"GET\",success:function(data){OF.WeiboUrl=data.weibo_url;OF.sendAction('openBrowser',{src:OF.WeiboUrl,callback:'OF.page.weiboDidReturn',timeout:30000,on_failure:'OF.page.facebookDidFailtown'});}});});$('#facebook_search').show();$('#renren_search').touch(function(){OF.api.request('/xp/rrgeturl',{method:\"GET\",success:function(data){OF.RenrenUrl=data.renren_url;OF.sendAction('openBrowser',{src:OF.RenrenUrl,callback:'OF.page.renrenDidReturn',timeout:30000,on_failure:'OF.page.facebookDidFailtown'});}});});$('#renren_search').show();$('#tencent_search').touch(function(){OF.api.request('/xp/txgeturl',{method:\"GET\",success:function(data){OF.TencentUrl=data.tencent_url;OF.sendAction('openBrowser',{src:OF.TencentUrl,callback:'OF.page.tencentDidReturn',timeout:30000,on_failure:'OF.page.facebookDidFailtown'});}});});$('#tencent_search').show();}\nOF.api.request('/xp/friends/snsstatus',{background:true,method:'GET',success:function(data){if(data.snsstatus.weibo_status){$('#facebook_search .subtitle').text('\u5df2\u7ed1\u5b9a');}else{$('#facebook_search .subtitle').text('\u672a\u7ed1\u5b9a');}\nif(data.snsstatus.renren_status){$('#renren_search .subtitle').text('\u5df2\u7ed1\u5b9a');}else{$('#renren_search .subtitle').text('\u672a\u7ed1\u5b9a');}\nif(data.snsstatus.tx_status){$('#tencent_search .subtitle').text('\u5df2\u7ed1\u5b9a');}else{$('#tencent_search .subtitle').text('\u672a\u7ed1\u5b9a');}}});","resume":"\nOF.setActiveFootermenu();OF.api.request('/xp/users/'+OF.page.user.id,{method:'GET',success:function(data){OF.page.user=data.user;OF.page.initRequest();OF.page.initTabs();}});","appear":"\n$('#header .title').html(OF.page.title);","html":"<div id='dashboard'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n<div class='title' id='home_button'></div>\n</div>\n          <script type=\"text/plain\" id=\"user_tmpl\">\n            <%\n  var style = \"\";\n  if (user.profile_picture_url) {\n    style = \"background-image: url(\" + user.profile_picture_url + \")\";\n  }\n%>\n\n<li class=\"user\" data-href=\"dashboard/user?user_id=<%= user.id %>\" style=\"height:90px;min-height:90px\">\n  <div class=\"image useravatar\" style=\"<%= style %>\">\n    <div class=\"overlay\"></div>\n  </div>\n  <div class=\"title user_name\"><%= user.name %></div>\n  <div class=\"feint_score hidden\"><%= user.gamer_score %></div>\n  <div>\n     <span class=\"experience_level\">Lv<%=user.experience_level %></span>\n     <span style=\"float:left\" id=\"gem_icon\"><img src=\"images/icon.brisks.level.<%=user.experience_level %>.png\" width=\"20\" height=\"20\"></span>\n     <span class=\"gamerscore_val\"><%=user.gamer_experience %></span>\n     <span class=\"gamerscore_exp\"></span>\n  </div>\n  <div class=\"last_play\" style=\"overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:250px\">\u6700\u8fd1\u5728\u73a9\uff1a<%= user.recent_play_game %></div>\n</li>\n          </script>\n          <script type=\"text/plain\" id=\"recommend_user_tmpl\">\n            <%\n  var style = \"\";\n  if (user.profile_picture_url) {\n    style = \"background-image: url(\" + user.profile_picture_url + \")\";\n  }\n%>\n\n<li class=\"user\" data-href=\"dashboard/user?user_id=<%= user.id %>\" style=\"height:140px;min-height:140px\">\n  <div class=\"image useravatar\" style=\"<%= style %>\">\n    <div class=\"overlay\"></div>\n  </div>\n  <div class=\"title user_name\"><%= user.name %></div>\n  <div class=\"feint_score hidden\"><%= user.gamer_score %></div>\n  <div>\n     <span class=\"experience_level\">Lv<%=user.experience_level %></span>\n     <span style=\"float:left\" id=\"gem_icon\"><img src=\"images/icon.brisks.level.<%=user.experience_level %>.png\" width=\"20\" height=\"20\"></span>\n     <span class=\"gamerscore_val\"><%=user.gamer_experience %></span>\n     <span class=\"gamerscore_exp\"></span>\n  </div>\n  <div class=\"last_play\" style=\"overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:250px\">\u6700\u8fd1\u5728\u73a9\uff1a<%= user.recent_play_game %></div>\n  <div id=\"<%= user.id %>\" class=\"button add_recommend_friend disabled\" style=\"margin:60px;\">\u52a0\u4e3a\u597d\u53cb</div>\n  <div id=\"pending_friend_<%= user.id %>\" class=\"button added_recommend_friend disabled hidden\" style=\"opacity:0.5;margin:60px;\">\u5df2\u52a0\u4e3a\u597d\u53cb</div>\n</li>\n          </script>\n<div id='friends'>\n<section id='tabbed_friend_navigation'>\n<ul class='tabs'>\n<li class='tab' id='friends_tab'>\n<div class='label t'>My Friends</div>\n</li>\n<li class='tab active' id='find_friends_tab'>\n<div class='label t'>Find Friends</div>\n</li>\n</ul>\n</section>\n<section class='hidden' data-href='dashboard/friend_requests' id='requests'>\n<h3 class='section_title t'>Friend Requests</h3>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='title'></div>\n</div>\n</section>\n<div id='friends_search'>\n<section class='find_friends'>\n<h3 class='section_title'>\u627e\u670b\u53cb</h3>\n<section id='find_friends'>\n<div class='cell one_line' data-href='dashboard/user_search'>\n<div class='icon'></div>\n<div class='title t'>Search by Feint Name</div>\n</div>\n</section>\n<section id='facebook_search'>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='snstitle t'>\u65b0\u6d6a\u5fae\u535a\u597d\u53cb</div>\n<div class='subtitle'></div>\n</div>\n</section>\n<section id='renren_search'>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='snstitle t'>\u4eba\u4eba\u7f51\u597d\u53cb</div>\n<div class='subtitle'></div>\n</div>\n</section>\n<section id='tencent_search'>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='snstitle t'>\u817e\u8baf\u5fae\u535a\u597d\u53cb</div>\n<div class='subtitle'></div>\n</div>\n</section>\n</section>\n<section id='recommend_friends'>\n<h3 class='section_title'>\u8d85\u7ea7\u73a9\u5bb6\u63a8\u8350</h3>\n<ul class='cells' id='loading'>\n<li class='loading'>\n<div class='spinner'></div>\n</li>\n</ul>\n</section>\n</div>\n<div class='hidden' id='friends_container'>\n<section id='friends_list'>\n<h3 class='section_title t'>Your Friends</h3>\n<ul class='cells'>\n<li class='load_more hidden' id='load_more'>\u8bfb\u53d6\u66f4\u591a</li>\n</ul>\n</section>\n<section class='hidden' id='recommend_friends'>\n<h3 class='section_title'>\u60a8\u8fd8\u6ca1\u6709\u597d\u53cb\uff01\u5411\u60a8\u63a8\u8350\u4ee5\u4e0b\u73a9\u5bb6</h3>\n<ul class='cells' id='loading'>\n<li class='loading'>\n<div class='spinner'></div>\n</li>\n</ul>\n</section>\n<section class='find_friends hidden'>\n<h3 class='section_title'>\u627e\u670b\u53cb</h3>\n<section id='find_friends'>\n<div class='cell one_line' data-href='dashboard/user_search'>\n<div class='icon'></div>\n<div class='title t'>Search by Feint Name</div>\n</div>\n</section>\n<section id='facebook_search'>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='snstitle t'>\u65b0\u6d6a\u5fae\u535a\u597d\u53cb</div>\n<div class='subtitle'></div>\n</div>\n</section>\n<section id='renren_search'>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='snstitle t'>\u4eba\u4eba\u7f51\u597d\u53cb</div>\n<div class='subtitle'></div>\n</div>\n</section>\n<section id='tencent_search'>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='snstitle t'>\u817e\u8baf\u5fae\u535a\u597d\u53cb</div>\n<div class='subtitle'></div>\n</div>\n</section>\n</section>\n</div>\n<ul class='cells hidden' id='loading'>\n<li class='loading'>\n<div class='spinner'></div>\n</li>\n</ul>\n</div>\n\n<br clear='both'>\n<div id='footer'>\n<div class='footer_menu' id='footer_menu_for_2_1' style='display:none'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n<br clear='both'>\n<div class='footer_menu' id='footer_menu_for_2_2'>\n<ul class='footer_tabs'>\n<li class='footer_tab active'>\n<label class='user_tab'>\u6211\u7684\u7a7a\u95f4</label>\n<div class='right_bar'></div>\n</li>\n<li class='footer_tab' style='border-right:none'>\n<label class='game_tab'>\u6e38\u620f\u63a8\u8350</label>\n<div class='right_bar'></div>\n</li>\n</ul>\n</div>\n</div>\n"}